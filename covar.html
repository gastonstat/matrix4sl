<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>10 Covariance and Correlation | A Matrix Algebra Companion for Statistical Learning</title>
  <meta name="description" content="This book provides a review of matrix algebra concepts central to the study of Statistical Learning Methods." />
  <meta name="generator" content="bookdown 0.13 and GitBook 2.6.7" />

  <meta property="og:title" content="10 Covariance and Correlation | A Matrix Algebra Companion for Statistical Learning" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://www.gastonsanchez.com/matrix4sl/" />
  
  <meta property="og:description" content="This book provides a review of matrix algebra concepts central to the study of Statistical Learning Methods." />
  <meta name="github-repo" content="gastonstat/matrix4sl" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="10 Covariance and Correlation | A Matrix Algebra Companion for Statistical Learning" />
  
  <meta name="twitter:description" content="This book provides a review of matrix algebra concepts central to the study of Statistical Learning Methods." />
  

<meta name="author" content="Gaston Sanchez" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="variance.html"/>
<link rel="next" href="crossprods.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">matrix4sl</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#give-now"><i class="fa fa-check"></i>Give Now</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#how-this-book-is-organized"><i class="fa fa-check"></i><b>1.1</b> How this book is organized?</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#prerequisites"><i class="fa fa-check"></i><b>1.2</b> Prerequisites</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#why-this-book"><i class="fa fa-check"></i><b>1.3</b> Why this book?</a></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#acknowledgements"><i class="fa fa-check"></i><b>1.4</b> Acknowledgements</a></li>
</ul></li>
<li class="part"><span><b>I Data Essentials</b></span></li>
<li class="chapter" data-level="2" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>2</b> Data Tables</a><ul>
<li class="chapter" data-level="2.1" data-path="data.html"><a href="data.html#data-individuals-and-variables"><i class="fa fa-check"></i><b>2.1</b> Data: Individuals and Variables</a><ul>
<li class="chapter" data-level="2.1.1" data-path="data.html"><a href="data.html#representing-data"><i class="fa fa-check"></i><b>2.1.1</b> Representing Data</a></li>
<li class="chapter" data-level="2.1.2" data-path="data.html"><a href="data.html#tabular-data"><i class="fa fa-check"></i><b>2.1.2</b> Tabular Data</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="data.html"><a href="data.html#types-of-tables"><i class="fa fa-check"></i><b>2.2</b> Types of Tables</a><ul>
<li class="chapter" data-level="2.2.1" data-path="data.html"><a href="data.html#heterogeneous-table"><i class="fa fa-check"></i><b>2.2.1</b> Heterogeneous Table</a></li>
<li class="chapter" data-level="2.2.2" data-path="data.html"><a href="data.html#binary-table"><i class="fa fa-check"></i><b>2.2.2</b> Binary table</a></li>
<li class="chapter" data-level="2.2.3" data-path="data.html"><a href="data.html#modalities-table"><i class="fa fa-check"></i><b>2.2.3</b> Modalities table</a></li>
<li class="chapter" data-level="2.2.4" data-path="data.html"><a href="data.html#preference-table"><i class="fa fa-check"></i><b>2.2.4</b> Preference table</a></li>
<li class="chapter" data-level="2.2.5" data-path="data.html"><a href="data.html#frequency-table"><i class="fa fa-check"></i><b>2.2.5</b> Frequency table</a></li>
<li class="chapter" data-level="2.2.6" data-path="data.html"><a href="data.html#distance-table"><i class="fa fa-check"></i><b>2.2.6</b> Distance table</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="data.html"><a href="data.html#summary"><i class="fa fa-check"></i><b>2.3</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="datamatrix.html"><a href="datamatrix.html"><i class="fa fa-check"></i><b>3</b> Data Matrix</a><ul>
<li class="chapter" data-level="3.1" data-path="datamatrix.html"><a href="datamatrix.html#about-matrices"><i class="fa fa-check"></i><b>3.1</b> About Matrices</a></li>
<li class="chapter" data-level="3.2" data-path="datamatrix.html"><a href="datamatrix.html#data-matrix"><i class="fa fa-check"></i><b>3.2</b> Data Matrix</a><ul>
<li class="chapter" data-level="3.2.1" data-path="datamatrix.html"><a href="datamatrix.html#why-a-data-matrix"><i class="fa fa-check"></i><b>3.2.1</b> Why a data matrix?</a></li>
<li class="chapter" data-level="3.2.2" data-path="datamatrix.html"><a href="datamatrix.html#matrix-representations"><i class="fa fa-check"></i><b>3.2.2</b> Matrix Representations</a></li>
<li class="chapter" data-level="3.2.3" data-path="datamatrix.html"><a href="datamatrix.html#a-block-of-variables"><i class="fa fa-check"></i><b>3.2.3</b> A Block of Variables</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="datamatrix.html"><a href="datamatrix.html#types-of-matrices"><i class="fa fa-check"></i><b>3.3</b> Types of Matrices</a><ul>
<li class="chapter" data-level="3.3.1" data-path="datamatrix.html"><a href="datamatrix.html#general-rectangular-matrix"><i class="fa fa-check"></i><b>3.3.1</b> General Rectangular Matrix</a></li>
<li class="chapter" data-level="3.3.2" data-path="datamatrix.html"><a href="datamatrix.html#square-matrix"><i class="fa fa-check"></i><b>3.3.2</b> Square Matrix</a></li>
<li class="chapter" data-level="3.3.3" data-path="datamatrix.html"><a href="datamatrix.html#symmetric-matrix"><i class="fa fa-check"></i><b>3.3.3</b> Symmetric Matrix</a></li>
<li class="chapter" data-level="3.3.4" data-path="datamatrix.html"><a href="datamatrix.html#diagonal-matrix"><i class="fa fa-check"></i><b>3.3.4</b> Diagonal Matrix</a></li>
<li class="chapter" data-level="3.3.5" data-path="datamatrix.html"><a href="datamatrix.html#scalar-matrix"><i class="fa fa-check"></i><b>3.3.5</b> Scalar Matrix</a></li>
<li class="chapter" data-level="3.3.6" data-path="datamatrix.html"><a href="datamatrix.html#identity-matrix"><i class="fa fa-check"></i><b>3.3.6</b> Identity Matrix</a></li>
<li class="chapter" data-level="3.3.7" data-path="datamatrix.html"><a href="datamatrix.html#triangular-matrix"><i class="fa fa-check"></i><b>3.3.7</b> Triangular Matrix</a></li>
<li class="chapter" data-level="3.3.8" data-path="datamatrix.html"><a href="datamatrix.html#shapes-of-matrices"><i class="fa fa-check"></i><b>3.3.8</b> Shapes of Matrices</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="variables.html"><a href="variables.html"><i class="fa fa-check"></i><b>4</b> Variables</a><ul>
<li class="chapter" data-level="4.1" data-path="variables.html"><a href="variables.html#types-of-variables"><i class="fa fa-check"></i><b>4.1</b> Types of Variables</a></li>
<li class="chapter" data-level="4.2" data-path="variables.html"><a href="variables.html#variable-flavors"><i class="fa fa-check"></i><b>4.2</b> Variable Flavors</a><ul>
<li class="chapter" data-level="4.2.1" data-path="variables.html"><a href="variables.html#nominal-variable"><i class="fa fa-check"></i><b>4.2.1</b> Nominal Variable</a></li>
<li class="chapter" data-level="4.2.2" data-path="variables.html"><a href="variables.html#ordinal-variable"><i class="fa fa-check"></i><b>4.2.2</b> Ordinal Variable</a></li>
<li class="chapter" data-level="4.2.3" data-path="variables.html"><a href="variables.html#discrete-variable"><i class="fa fa-check"></i><b>4.2.3</b> Discrete Variable</a></li>
<li class="chapter" data-level="4.2.4" data-path="variables.html"><a href="variables.html#continuous-variable"><i class="fa fa-check"></i><b>4.2.4</b> Continuous Variable</a></li>
<li class="chapter" data-level="4.2.5" data-path="variables.html"><a href="variables.html#caveat"><i class="fa fa-check"></i><b>4.2.5</b> Caveat</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="variables.html"><a href="variables.html#encoding-values"><i class="fa fa-check"></i><b>4.3</b> Encoding Values</a><ul>
<li class="chapter" data-level="4.3.1" data-path="variables.html"><a href="variables.html#more-on-encoding"><i class="fa fa-check"></i><b>4.3.1</b> More on encoding</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="transformations.html"><a href="transformations.html"><i class="fa fa-check"></i><b>5</b> Transformations</a><ul>
<li class="chapter" data-level="5.1" data-path="transformations.html"><a href="transformations.html#dummy-variables"><i class="fa fa-check"></i><b>5.1</b> Dummy Variables</a></li>
<li class="chapter" data-level="5.2" data-path="transformations.html"><a href="transformations.html#standardization"><i class="fa fa-check"></i><b>5.2</b> Standardization</a><ul>
<li class="chapter" data-level="5.2.1" data-path="transformations.html"><a href="transformations.html#by-standard-units"><i class="fa fa-check"></i><b>5.2.1</b> By Standard Units</a></li>
<li class="chapter" data-level="5.2.2" data-path="transformations.html"><a href="transformations.html#by-the-overall-range"><i class="fa fa-check"></i><b>5.2.2</b> By the Overall Range</a></li>
<li class="chapter" data-level="5.2.3" data-path="transformations.html"><a href="transformations.html#by-chosen-percentiles"><i class="fa fa-check"></i><b>5.2.3</b> By Chosen Percentiles</a></li>
<li class="chapter" data-level="5.2.4" data-path="transformations.html"><a href="transformations.html#by-the-mean"><i class="fa fa-check"></i><b>5.2.4</b> By the Mean</a></li>
<li class="chapter" data-level="5.2.5" data-path="transformations.html"><a href="transformations.html#about-standardization"><i class="fa fa-check"></i><b>5.2.5</b> About standardization</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="transformations.html"><a href="transformations.html#logarithmic-transformations"><i class="fa fa-check"></i><b>5.3</b> Logarithmic Transformations</a></li>
<li class="chapter" data-level="5.4" data-path="transformations.html"><a href="transformations.html#power-transformations"><i class="fa fa-check"></i><b>5.4</b> Power Transformations</a></li>
</ul></li>
<li class="part"><span><b>II Geometric Mindset</b></span></li>
<li class="chapter" data-level="6" data-path="duality.html"><a href="duality.html"><i class="fa fa-check"></i><b>6</b> Geometric Duality</a><ul>
<li class="chapter" data-level="6.1" data-path="duality.html"><a href="duality.html#matrix-perspectives"><i class="fa fa-check"></i><b>6.1</b> Matrix Perspectives</a><ul>
<li class="chapter" data-level="6.1.1" data-path="duality.html"><a href="duality.html#rows-space"><i class="fa fa-check"></i><b>6.1.1</b> Rows Space</a></li>
<li class="chapter" data-level="6.1.2" data-path="duality.html"><a href="duality.html#columns-space"><i class="fa fa-check"></i><b>6.1.2</b> Columns Space</a></li>
<li class="chapter" data-level="6.1.3" data-path="duality.html"><a href="duality.html#toy-example"><i class="fa fa-check"></i><b>6.1.3</b> Toy Example</a></li>
<li class="chapter" data-level="6.1.4" data-path="duality.html"><a href="duality.html#dual-space"><i class="fa fa-check"></i><b>6.1.4</b> Dual Space</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="vector-basics.html"><a href="vector-basics.html"><i class="fa fa-check"></i><b>7</b> Vector Basics</a><ul>
<li class="chapter" data-level="7.1" data-path="vector-basics.html"><a href="vector-basics.html#inner-product"><i class="fa fa-check"></i><b>7.1</b> Inner Product</a></li>
<li class="chapter" data-level="7.2" data-path="vector-basics.html"><a href="vector-basics.html#length"><i class="fa fa-check"></i><b>7.2</b> Length</a></li>
<li class="chapter" data-level="7.3" data-path="vector-basics.html"><a href="vector-basics.html#angle"><i class="fa fa-check"></i><b>7.3</b> Angle</a></li>
<li class="chapter" data-level="7.4" data-path="vector-basics.html"><a href="vector-basics.html#orthogonality"><i class="fa fa-check"></i><b>7.4</b> Orthogonality</a></li>
<li class="chapter" data-level="7.5" data-path="vector-basics.html"><a href="vector-basics.html#projection"><i class="fa fa-check"></i><b>7.5</b> Projection</a></li>
</ul></li>
<li class="part"><span><b>III Statistical Measures</b></span></li>
<li class="chapter" data-level="8" data-path="mean.html"><a href="mean.html"><i class="fa fa-check"></i><b>8</b> Mean</a><ul>
<li class="chapter" data-level="8.1" data-path="mean.html"><a href="mean.html#mean-of-a-variable"><i class="fa fa-check"></i><b>8.1</b> Mean of a variable</a></li>
<li class="chapter" data-level="8.2" data-path="mean.html"><a href="mean.html#mean-as-a-balancing-point"><i class="fa fa-check"></i><b>8.2</b> Mean as a Balancing Point</a></li>
<li class="chapter" data-level="8.3" data-path="mean.html"><a href="mean.html#mean-with-vector-notation"><i class="fa fa-check"></i><b>8.3</b> Mean with Vector Notation</a></li>
<li class="chapter" data-level="8.4" data-path="mean.html"><a href="mean.html#mean-as-a-projection"><i class="fa fa-check"></i><b>8.4</b> Mean as a Projection</a></li>
<li class="chapter" data-level="8.5" data-path="mean.html"><a href="mean.html#centroid"><i class="fa fa-check"></i><b>8.5</b> Centroid</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="variance.html"><a href="variance.html"><i class="fa fa-check"></i><b>9</b> Variance</a><ul>
<li class="chapter" data-level="9.1" data-path="variance.html"><a href="variance.html#about-the-variance"><i class="fa fa-check"></i><b>9.1</b> About the variance</a><ul>
<li class="chapter" data-level="9.1.1" data-path="variance.html"><a href="variance.html#sample-variance"><i class="fa fa-check"></i><b>9.1.1</b> Sample Variance</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="variance.html"><a href="variance.html#variance-with-vector-notation"><i class="fa fa-check"></i><b>9.2</b> Variance with Vector Notation</a></li>
<li class="chapter" data-level="9.3" data-path="variance.html"><a href="variance.html#standard-deviation-as-a-norm"><i class="fa fa-check"></i><b>9.3</b> Standard Deviation as a Norm</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="covar.html"><a href="covar.html"><i class="fa fa-check"></i><b>10</b> Covariance and Correlation</a><ul>
<li class="chapter" data-level="10.1" data-path="covar.html"><a href="covar.html#two-variables"><i class="fa fa-check"></i><b>10.1</b> Two Variables</a></li>
<li class="chapter" data-level="10.2" data-path="covar.html"><a href="covar.html#covariance"><i class="fa fa-check"></i><b>10.2</b> Covariance</a></li>
<li class="chapter" data-level="10.3" data-path="covar.html"><a href="covar.html#correlation"><i class="fa fa-check"></i><b>10.3</b> Correlation</a></li>
<li class="chapter" data-level="10.4" data-path="covar.html"><a href="covar.html#relation-as-linear-approximation"><i class="fa fa-check"></i><b>10.4</b> Relation as Linear Approximation</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="crossprods.html"><a href="crossprods.html"><i class="fa fa-check"></i><b>11</b> Matrix Cross-Products</a><ul>
<li class="chapter" data-level="11.1" data-path="crossprods.html"><a href="crossprods.html#common-data-matrices"><i class="fa fa-check"></i><b>11.1</b> Common Data Matrices</a></li>
<li class="chapter" data-level="11.2" data-path="crossprods.html"><a href="crossprods.html#cross-products"><i class="fa fa-check"></i><b>11.2</b> Cross-Products</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Thanks to bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A Matrix Algebra Companion for Statistical Learning</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="covar" class="section level1">
<h1><span class="header-section-number">10</span> Covariance and Correlation</h1>
<p>One of the most common tasks in statistics and data analysis that we have to deal with is answering the ever-present question: Given two variables <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>, what is the relationship between them? The answer to this question largely depends on two major factors.</p>
<p>One factor is the way in which the notion of “relationship” is defined in mathematical terms. The other factor has to do with the nature of the variables (e.g. continuous, discrete, ordinal, nominal, binary, etc).</p>
<div id="two-variables" class="section level2">
<h2><span class="header-section-number">10.1</span> Two Variables</h2>
<p>Let us start by considering the most simple scenario when we have two variables <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>, represented by vectors <span class="math inline">\(\mathbf{x}\)</span> and <span class="math inline">\(\mathbf{y}\)</span>, respectively.</p>
<p>Different types of relations between <span class="math inline">\(\mathbf{x}\)</span> and <span class="math inline">\(\mathbf{y}\)</span> are possible, as shown in the figure below containing several scatter-plots. There are linear relations of both type positive and negative. There are also two types of nonlinear relations, one monotone and the other one non-montone. In addition, the last two plots show absence of relations.</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-61"></span>
<img src="images/covar/bivariate-relations.png" alt="Different relations between two variables" width="70%" />
<p class="caption">
Figure 10.1: Different relations between two variables
</p>
</div>
<p><br></p>
<ul>
<li><p><strong>Positive linear relation</strong>: <span class="math inline">\(\mathbf{x}\)</span> and <span class="math inline">\(\mathbf{y}\)</span> vary simultaneously in the same direction; an increase in <span class="math inline">\(\mathbf{x}\)</span> is accompanied by an increase in <span class="math inline">\(\mathbf{y}\)</span> in constant proportion.</p></li>
<li><p><strong>Negative linear relation</strong>: <span class="math inline">\(\mathbf{x}\)</span> and <span class="math inline">\(\mathbf{y}\)</span> vary in opposite directions; an increase in <span class="math inline">\(\mathbf{x}\)</span> is accompanied by a decrease in <span class="math inline">\(\mathbf{y}\)</span>.</p></li>
<li><p><strong>Nonlinear monotone relation</strong>: <span class="math inline">\(\mathbf{x}\)</span> and <span class="math inline">\(\mathbf{y}\)</span> vary in the same direction but the slope is not constant; changes in <span class="math inline">\(\mathbf{y}\)</span> are different dependening on the values of <span class="math inline">\(\mathbf{x}\)</span>.</p></li>
<li><p><strong>Nonlinear non-monotone relation</strong>: although there is a functional relation between <span class="math inline">\(\mathbf{x}\)</span> and <span class="math inline">\(\mathbf{y}\)</span>, the relation is not monotone; <span class="math inline">\(\mathbf{y}\)</span> increases and decrases accordingly to <span class="math inline">\(\mathbf{x}\)</span>.</p></li>
<li><p><strong>No relation</strong>: regardless of the values of <span class="math inline">\(\mathbf{x}\)</span>, two things may happen. One is that knowing <span class="math inline">\(\mathbf{x}\)</span>, nothing can be said about <span class="math inline">\(\mathbf{y}\)</span>; the other is that <span class="math inline">\(\mathbf{y}\)</span> remains constant.</p></li>
</ul>
<p>For convenience sake most multivariate techniques focus on linear relations. Even though two variables <span class="math inline">\(\mathbf{x}\)</span> and <span class="math inline">\(\mathbf{y}\)</span> may show a nonlinear relation, it is often possible to apply some transformation to one of the them in order to have a more linear association.</p>
<p>The general approach to determine if <span class="math inline">\(\mathbf{x}\)</span> and <span class="math inline">\(\mathbf{y}\)</span> are related is to assess whether there is <em>simultaneous variation</em> between them. The idea is to define a measure for <em>quantifying</em> the strength of the relation. When <span class="math inline">\(\mathbf{x}\)</span> and <span class="math inline">\(\mathbf{y}\)</span> are in a quantitative scale, the most common way to quantify and assess the relationship between them is with the covariance and correlation.</p>
</div>
<div id="covariance" class="section level2">
<h2><span class="header-section-number">10.2</span> Covariance</h2>
<p>The covariance generalizes the concept of variance for two variables. Recall that the formula for the covariance between <span class="math inline">\(\mathbf{x}\)</span> and <span class="math inline">\(\mathbf{y}\)</span> is:</p>
<p><span class="math display">\[
cov(\mathbf{x, y}) = \frac{1}{n} \sum_{i=1}^{n} (x_i - \bar{x}) (y_i - \bar{y})
\]</span></p>
<p>where <span class="math inline">\(\bar{x}\)</span> is the mean value of <span class="math inline">\(\mathbf{x}\)</span> obtained as:</p>
<p><span class="math display">\[
\bar{x} = \frac{1}{n} (x_1 + x_2 + \dots + x_n) = \frac{1}{n} \sum_{i = 1}^{n} x_i
\]</span></p>
<p>and <span class="math inline">\(\bar{y}\)</span> is the mean value of <span class="math inline">\(\mathbf{y}\)</span>:</p>
<p><span class="math display">\[
\bar{y} = \frac{1}{n} (y_1 + y_2 + \dots + y_n) = \frac{1}{n} \sum_{i = 1}^{n} y_i
\]</span></p>
<p>Basically, the covariance is a statistical summary that is used to assess the <strong>linear association between pairs of variables</strong>.</p>
<p>Assuming that the variables are mean-centered, we can get a more compact expression of the covariance in vector notation:</p>
<p><span class="math display">\[
cov(\mathbf{x, y}) = \frac{1}{n} (\mathbf{x^\mathsf{T} y})
\]</span></p>
<p>Properties of covariance:</p>
<ul>
<li>the covariance is a symmetric index: <span class="math inline">\(cov(X,Y) = cov(Y,X)\)</span></li>
<li>the covariance can take any real value (negative, null, positive)</li>
<li>the covariance is linked to variances under the name of the Cauchy-Schwarz inequality: <span class="math display">\[cov(X,Y)^2 \leq var(X) var(Y) \]</span></li>
</ul>
</div>
<div id="correlation" class="section level2">
<h2><span class="header-section-number">10.3</span> Correlation</h2>
<p>Although the covariance indicates the direction—positive or negative—of a possible linear relation, it does not tell us how big or small the relation might be. To have a more interpretable index, we must transform the convariance into a unit-free measure. To do this we must consider the standard deviations of the variables so we can normalize the convariance. The result of this normalization is the coefficient of linear correlation defined as:</p>
<p><span class="math display">\[
cor(X, Y) = \frac{cov(X, Y)}{\sqrt{var(X)} \sqrt{var(Y)}}
\]</span></p>
<p>Representing <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> as vectors <span class="math inline">\(\mathbf{x}\)</span> and <span class="math inline">\(\mathbf{y}\)</span>, we can express the correlation as:</p>
<p><span class="math display">\[
cor(\mathbf{x}, \mathbf{y}) = \frac{cov(\mathbf{x}, \mathbf{y})}{\sqrt{var(\mathbf{x})} \sqrt{var(\mathbf{y})}}
\]</span></p>
<p>Assuming that <span class="math inline">\(\mathbf{x}\)</span> and <span class="math inline">\(\mathbf{y}\)</span> are mean-centered, we can express the correlation as:</p>
<p><span class="math display">\[
cor(\mathbf{x, y}) = \frac{\mathbf{x^\mathsf{T} y}}{\|\mathbf{x}\| \|\mathbf{y}\|}
\]</span></p>
<p>As it turns out, the norm of a mean-centered variable <span class="math inline">\(\mathbf{x}\)</span> is proportional to the square root of its variance (or standard deviation):</p>
<p><span class="math display">\[
\| \mathbf{x} \| = \sqrt{\mathbf{x^\mathsf{T} x}} 
 = \sqrt{n} \sqrt{var(\mathbf{x})}
\]</span></p>
<p>Consequently, we can also express the correlation with inner products as:</p>
<p><span class="math display">\[
cor(\mathbf{x, y}) = \frac{\mathbf{x^\mathsf{T} y}}{\sqrt{(\mathbf{x^\mathsf{T} x})} \sqrt{(\mathbf{y^\mathsf{T} y})}}
\]</span></p>
<p>or equivalently:</p>
<p><span class="math display">\[
cor(\mathbf{x, y}) = \frac{\mathbf{x^\mathsf{T} y}}{\| \mathbf{x} \| \hspace{1mm} \| \mathbf{y} \|}
\]</span></p>
<p>In the case that both <span class="math inline">\(\mathbf{x}\)</span> and <span class="math inline">\(\mathbf{y}\)</span> are standardized (mean zero and unit variance), that is:</p>
<p><span class="math display">\[
\mathbf{x} = \begin{bmatrix}
\frac{x_1 - \bar{x}}{\sigma_{x}} \\
\frac{x_2 - \bar{x}}{\sigma_{x}} \\
\vdots \\
\frac{x_n - \bar{x}}{\sigma_{x}}
\end{bmatrix},
\hspace{5mm}
\mathbf{y} = \begin{bmatrix}
\frac{y_1 - \bar{y}}{\sigma_{y}} \\
\frac{y_2 - \bar{y}}{\sigma_{y}} \\
\vdots \\
\frac{y_n - \bar{y}}{\sigma_{y}}
\end{bmatrix}
\]</span></p>
<p>the correlation is simply the inner product:</p>
<p><span class="math display">\[
cor(\mathbf{x, y}) = \mathbf{x^\mathsf{T} y} \hspace{5mm} \mathrm{(standardized} \hspace{1mm} \mathrm{variables)}
\]</span></p>
<p>Let’s look at two variables (i.e. vectors) from a geometric perspective.</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-62"></span>
<img src="matrix4sl_files/figure-html/unnamed-chunk-62-1.png" alt="Two vectors in a 2-dimensional space" width="70%" />
<p class="caption">
Figure 10.2: Two vectors in a 2-dimensional space
</p>
</div>
<p>The inner product ot two mean-centered vectors <span class="math inline">\(\mathbf{x&#39;y}\)</span> is obtained with the following equation:</p>
<p><span class="math display">\[
\mathbf{x^\mathsf{T} y} = \|\mathbf{x}\| \|\mathbf{y}\| cos(\theta_{x,y})
\]</span></p>
<p>where <span class="math inline">\(cos(\theta_{x,y})\)</span> is the angle between <span class="math inline">\(\mathbf{x}\)</span> and <span class="math inline">\(\mathbf{y}\)</span>. Rearranging the terms in the previous equation we get that:</p>
<p><span class="math display">\[
cos(\theta_{x,y}) = \frac{\mathbf{x^\mathsf{T} y}}{\|\mathbf{x}\| \|\mathbf{y}\|} = cor(\mathbf{x, y}) 
\]</span></p>
<p>which means that the correlation between mean-centered vectors <span class="math inline">\(\mathbf{x}\)</span> and <span class="math inline">\(\mathbf{y}\)</span> turns out to be the cosine of the angle between <span class="math inline">\(\mathbf{x}\)</span> and <span class="math inline">\(\mathbf{y}\)</span>.</p>
</div>
<div id="relation-as-linear-approximation" class="section level2">
<h2><span class="header-section-number">10.4</span> Relation as Linear Approximation</h2>
<p>A linked but different way to examine relations between the variables is when we ask: Can we approximate one of the variables in terms of the other? This is an asymmetric type of association since we seek to say something about the variability of one variable, say <span class="math inline">\(\mathbf{y}\)</span>, in terms of the variability of <span class="math inline">\(\mathbf{x}\)</span>.</p>
<p>We can think of several ways to approximate <span class="math inline">\(\mathbf{y}\)</span> in terms of <span class="math inline">\(\mathbf{x}\)</span>. The approximation of <span class="math inline">\(\mathbf{y}\)</span>, denoted by <span class="math inline">\(\hat{\mathbf{y}}\)</span>, means finding a coefficient <span class="math inline">\(b\)</span> such that:</p>
<p><span class="math display">\[
\hat{\mathbf{y}} = b \mathbf{x}
\]</span></p>
<p>The common approach to get <span class="math inline">\(\hat{\mathbf{y}}\)</span> in some optimal way is by minimizing the square difference between <span class="math inline">\(\mathbf{y}\)</span> and <span class="math inline">\(\hat{\mathbf{y}}\)</span>.</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-63"></span>
<img src="images/covar/vectors-approximation.png" alt="Linear approximation" width="70%" />
<p class="caption">
Figure 10.3: Linear approximation
</p>
</div>
<p>The answer to this question comes in the form of a projection. More precisely, we orthogonally project <span class="math inline">\(\mathbf{y}\)</span> onto <span class="math inline">\(\mathbf{x}\)</span>:</p>
<p><span class="math display">\[
\hat{\mathbf{y}} = \mathbf{x} \left( \frac{\mathbf{y^\mathsf{T} x}}{\mathbf{x^\mathsf{T} x}} \right)
\]</span></p>
<p>or equivalently:</p>
<p><span class="math display">\[
\hat{\mathbf{y}} = \mathbf{x} \left( \frac{\mathbf{y^\mathsf{T} x}}{\| \mathbf{x} \|^2} \right)
\]</span></p>
<p>Note that the term in parenthesis is just a scalar, so we can actually express <span class="math inline">\(\hat{\mathbf{y}}\)</span> as <span class="math inline">\(b \mathbf{x}\)</span>. This means that a projection implies multiplying <span class="math inline">\(\mathbf{x}\)</span> by some number <span class="math inline">\(b\)</span>, such that <span class="math inline">\(\hat{\mathbf{y}} = b \mathbf{x}\)</span> is a stretched or shrinked version of <span class="math inline">\(\mathbf{x}\)</span>. This is nothing else than the least squares regression of <span class="math inline">\(\mathbf{y}\)</span> on <span class="math inline">\(\mathbf{x}\)</span>. This is better appreciated in the following figure.</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-64"></span>
<img src="images/covar/orthogonal-projection.png" alt="Orthogonal projection" width="70%" />
<p class="caption">
Figure 10.4: Orthogonal projection
</p>
</div>
<p>Note that the correlation between <span class="math inline">\(\mathbf{y}\)</span> and <span class="math inline">\(\hat{\mathbf{y}}\)</span> is:</p>
<p><span class="math display">\[
cor(\mathbf{y}, \hat{\mathbf{y}}) = \frac{\mathbf{y^\mathsf{T} x}}{\| \mathbf{y} \|}
\]</span></p>
<p>or alternatively:</p>
<p><span class="math display">\[
cor^{2}(\mathbf{y}, \hat{\mathbf{y}}) = \frac{\mathbf{y^\mathsf{T} x}}{\mathbf{y^\mathsf{T}}y}
\]</span></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="variance.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="crossprods.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["matrix4sl.pdf", "matrix4sl.epub"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
